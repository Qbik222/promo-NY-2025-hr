"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var r,n,o,c,i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return n=!(r=!0),{s:function(){i=i.call(e)},n:function(){var e=i.next();return r=e.done,e},e:function(e){n=!0,o=e},f:function(){try{r||null==i.return||i.return()}finally{if(n)throw o}}};if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return i&&(e=i),c=0,{s:t=function(){},n:function(){return c>=e.length?{done:!0}:{done:!1,value:e[c++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}!function(){var r,i,a,f,n="https://fav-prom.com/api_ny_ua",D=new URLSearchParams(window.location.search),x="reg",l="future",d="old",y="active",o=document.querySelector(".tableResults__body-other"),N=document.getElementById("top-users"),s=document.querySelectorAll(".unauth-msg"),u=document.querySelectorAll(".btn-join"),R=document.getElementById("results-table"),m=document.querySelectorAll(".took-part"),c=document.querySelectorAll(".route__item"),p=document.querySelector(".quest-play"),v=document.querySelectorAll(".questBtn"),h=document.querySelector(".quest"),_=document.querySelectorAll(".quest__item"),b=document.querySelector(".firstPlay"),S=new Date,e=document.querySelector("#ukLeng"),q=document.querySelector("#enLeng")?"en":e?"uk":"uk",B=["place1","place2","place3"],L={};function g(){var e=document.querySelectorAll("[data-translate]"),t=(e&&e.length&&e.forEach(function(e){var t=e.getAttribute("data-translate");e.innerHTML=L[t]||"*----NEED TO BE TRANSLATED----*   key:  "+t,e.removeAttribute("data-translate")}),void 0),r=void 0;if(t){for(var n=0,o=["uk","en"];n<o.length;n++){var c=o[n];t.classList.remove(r+c)}t.classList.add(r+q)}}var E=function(e,t){return fetch(n+e,_objectSpread({headers:{Accept:"application/json","Content-Type":"application/json"}},t||{})).then(function(e){return e.json()})};var t=function(){var e,t;e=document.querySelectorAll(".infoRules"),t=document.querySelector(".Footer_container--BSX"),e.forEach(function(e){e.addEventListener("click",function(){document.getElementById("dropOpen").open=!0})}),t||e.forEach(function(e){return e.classList.add("blockLink")}),v.forEach(function(e){return e.addEventListener("click",function(e){var t;f&&(t={userid:f},E("/questreg",{method:"POST",body:JSON.stringify(t)}).then(function(e){p.classList.remove("hide"),b.classList.remove("hide"),v.forEach(function(e){return e.classList.add("hide")})}))})}),Promise.all([E("/users?nocache=1"),E("/quests")]).then(function(e){r=e[0],i=e[1]||[],F(r),w(i,a),g()})};function w(e,t){if(e)for(var r=function(e){e=e[3];return e&&S>new Date(e.dateEnd)}(e)?4:0,n=0;n<c.length;n++)!function(e,t,r){if(e&&t){var n=e.qNumber,r=r&&r.quests&&r.quests.find(function(e){return e.questNum===n});t.querySelector(".route__item-title").innerHTML=j("nameQuest-".concat(n));t.querySelector(".route__item-subtitle").innerHTML=j("quest-".concat(n));var o=function(e){var t=new Date(e.dateStart),e=new Date(e.dateEnd);return S<t?l:e<S?d:y}(e);if(t.classList.remove("soon"),o===d?t.classList.add("inactive"):o===l?t.classList.add("soon"):(s=t.querySelector(".timerTxt"),u=document.querySelector(".quest__time-num"),function(e,t,r){O(e,t,r);var n=setInterval(function(){O(e,t,r)<0&&(clearInterval(n),t.innerHTML=T("finishedTimer",0,0,0),r.innerHTML=T("timer",0,0,0),location.reload())},1e4)}(e.dateEnd,s,u),t.classList.add("active"),function(e,t){var r=e.qNumber;document.querySelector(".quest__des-title").innerHTML=j("quest-".concat(r)),document.querySelector(".quest__des-text").innerHTML=j("descrQuest-".concat(r));document.querySelector(".quest__title").innerHTML=j("nameQuest-".concat(r));for(var n=r%2==0?"sport":"casino",o=(h.classList.add(n),h.classList.add("quest-popup".concat(r)),t?t.points:0),c=0;c<_.length;c++){var i,a,s,u,l=_[c],d=e.levels[c];l&&d&&(l.querySelector(".quest__item-subtitle").innerHTML=j("prizeQuest-".concat(r,"_").concat(c+1)),l.querySelector(".quest__item-info-text").innerHTML=j("stepQuest-".concat(r,"_").concat(c+1)),i=0===c?0:e.levels[c-1].points,d=d.points,a=Math.min(Math.max(o,0),d),s=a/d*100,s=Math.min(Math.max(Math.floor(s),0),100),(u=l.querySelector(".quest__item-info-progress")).value=s,u.dataset.progress="".concat(s,"%"),l.querySelector(".status").innerHTML="".concat(a,"/").concat(d),o<i||!f)&&l.querySelector(".took-part").classList.add("hide")}document.querySelectorAll(".quest__item-info-progress").forEach(function(e){var t=e.querySelector(".progress"),e=e.getAttribute("data-progress");t.style.width="calc(".concat(e," - 6px)")})}(e,r)),r)for(var c=t.querySelectorAll(".star"),i=function(e,t){var r;return e&&e.levels&&0!==e.levels.length?-1===(r=e.levels.findIndex(function(e){return t<e.points}))?e.levels.length:r:0}(e,r.points||0),a=0;a<i;a++)c[a].classList.add("_done");var s=t.querySelector(".src__desc"),u=t.querySelector(".src__mob"),e=t.querySelector(".src__default");s.srcset="https://fav-prom.com/html/ny-ua/img/route/quest".concat(n,"-img-desc.png"),u.srcset="https://fav-prom.com/html/ny-ua/img/route/quest".concat(n,"-img-mob.png"),e.src="https://fav-prom.com/html/ny-ua/img/route/quest".concat(n,"-img-desc.png"),o==y&&f&&!r&&(p.classList.add("hide"),b.classList.add("hide"),v.forEach(function(e){return e.classList.remove("hide")}))}}(e[n+r],c[n],t)}function T(e,t,r,n){return j(e).replace("{day}",t.toString()).replace("{hour}",r.toString()).replace("{minutes}",n.toString())}function O(e,t,r){var e=new Date(e),n=new Date,e=e.getTime()-n.getTime(),n=Math.floor(e/864e5),o=Math.floor(e%864e5/36e5),c=Math.floor(e%36e5/6e4);return t.innerHTML=T("finishedTimer",n,o,c),r.innerHTML=T("timer",n,o,c),e}function A(){f&&D.has(x)?M():t()}function M(){var e;f&&(e={userid:f},E("/user",{method:"POST",body:JSON.stringify(e)}).then(function(e){u.forEach(function(e){return e.classList.add("hide")}),m.forEach(function(e){return e.classList.remove("hide")}),t()}))}function F(e){var t;R.classList.remove("hide"),o.classList.remove("hide"),e&&e.length&&(k(e.slice(0,10),f,N,e),t=!(t=(t=f&&e.find(function(e){return e.userid===f}))&&e.indexOf(t))||t<10?e.slice(10,13):e.slice(Math.max(t-1,10),t+2))&&t.length&&k(t,f,o,e)}function k(e,c,i,a){i.innerHTML="",e&&e.length&&e.forEach(function(e){var t=c&&c===e.userid,r=document.createElement("div"),n=(r.classList.add("tableResults__row"),t&&r.classList.add("_yourPlace"),a.indexOf(e)+1),o=B[n-1],o=(o&&r.classList.add(o),(o=n)<=5?"prize_".concat(o):o<=10?"prize_6-10":o<=50?"prize_11-50":o<=100?"prize_51-100":o<=200?"prize_101-200":o<=201?"prize_201-300":o<=400?"prize_301-400":o<=500?"prize_401-500":o<=600?"prize_501-600":o<=650?"prize_601-650":o<=700?"prize_651-700":void 0);r.innerHTML='\n                        <div class="tableResults__body-col" '.concat(t,">").concat(n,'</div>\n                        <div class="tableResults__body-col">').concat(t?e.userid:"****"+e.userid.toString().slice(4),'</div>\n                        <div class="tableResults__body-col">').concat(e.points,'</div>\n                        <div class="tableResults__body-col">').concat(o?j(o):" - ","</div>\n                    "),i.append(r)})}function j(e){if(e)return L[e]||"*----NEED TO BE TRANSLATED----*   key:  "+e}function P(){if(f){var e,t=_createForOfIteratorHelper(s);try{for(t.s();!(e=t.n()).done;)e.value.classList.add("hide")}catch(e){t.e(e)}finally{t.f()}E("/favuser/".concat(f,"?nocache=1")).then(function(e){e&&e.userid?(u.forEach(function(e){return e.classList.add("hide")}),m.forEach(function(e){return e.classList.remove("hide")}),v.forEach(function(e){return e.classList.add("hide")}),w(i,a=e)):u.forEach(function(e){return e.classList.remove("hide")})})}else{var r,n=_createForOfIteratorHelper(u);try{for(n.s();!(r=n.n()).done;)r.value.classList.add("hide")}catch(e){n.e(e)}finally{n.f()}var o,c=_createForOfIteratorHelper(s);try{for(c.s();!(o=c.n()).done;)o.value.classList.remove("hide")}catch(e){c.e(e)}finally{c.f()}}}fetch("".concat(n,"/translates/").concat(q)).then(function(e){return e.json()}).then(function(e){L=e,g(),new MutationObserver(function(e){g()}).observe(document.getElementById("newYear2024"),{childList:!0,subtree:!0})}).then(function(){var e,t;window.store?(e=window.store.getState(),f=e.auth.isAuthorized&&e.auth.id||"",A()):(A(),t=setInterval(function(){window.g_user_id&&(f=window.g_user_id,A(),P(),clearInterval(t))},200)),P(),u.forEach(function(e,t){e.addEventListener("click",function(e){e.preventDefault(),M()})})});var K=document.querySelector(".fav__page");setTimeout(function(){return K.classList.add("overflow")},1e3);var H=document.querySelector("body"),e=document.querySelectorAll(".route__item"),I=document.querySelector(".popup"),Q=document.querySelector(".result__subtext"),z=document.querySelector(".prize-fund"),C=document.querySelector(".prize-fund-close");I.addEventListener("click",function(e){e.target.closest(".quest-close")&&(I.classList.add("_hidden"),H.style.overflow="auto",e=document.querySelector(".quest"))&&(e.style.display="none")}),e.forEach(function(e){e.addEventListener("click",function(){var e;I.classList.remove("_hidden"),H.style.overflow="hidden",(e=document.querySelector(".quest"))&&(e.style.display="block")})}),Q.addEventListener("click",function(){I.classList.remove("_hidden"),H.style.overflow="hidden",z.style.display="block"}),C.addEventListener("click",function(){I.classList.add("_hidden"),H.style.overflow="auto",z.style.display="none"}),document.querySelectorAll(".rules__item").forEach(function(e){e.addEventListener("click",function(){e.classList.toggle("_open")})}),document.querySelectorAll(".quest__item").forEach(function(e){e.addEventListener("click",function(){e.classList.toggle("_open")})})}();